# POE2 交易助手 - 测试指南

## 🔧 重新加载插件

由于我们对插件进行了重大更新，你需要重新加载插件：

1. 打开 `chrome://extensions/`
2. 找到"POE2 交易市场助手"
3. 点击"重新加载"按钮 🔄
4. 确认插件状态为"已启用"

## 🧪 功能测试步骤

### 1. 基础功能测试

**步骤 1：访问交易页面**

-   打开 `https://poe.game.qq.com/trade2`（国服）
-   页面加载完成后，右侧应该会出现历史记录面板

**步骤 2：验证面板显示**

-   面板标题应显示"🏺 搜索历史"
-   面板右上角有三个控制按钮：🔄 🗑️ 📋
-   面板下方有搜索输入框
-   初始状态可能显示"暂无搜索记录"

### 2. 搜索记录功能测试

**步骤 1：进行搜索**

-   在交易页面搜索任意物品（比如输入"弓"）
-   点击搜索按钮或按回车
-   等待搜索结果加载

**步骤 2：验证记录保存**

-   查看右侧历史面板是否出现新的搜索记录
-   记录应包含：搜索时间、搜索条件等信息
-   如果没有立即显示，点击面板的 🔄 刷新按钮

**步骤 3：测试多次搜索**

-   尝试搜索不同的物品
-   每次搜索后验证历史面板是否更新
-   记录应按时间倒序排列（最新的在上面）

### 3. 面板交互测试

**步骤 1：测试面板控制**

-   点击 📋 按钮，面板应该收起/展开
-   点击 🔄 按钮，历史记录应该刷新
-   点击 🗑️ 按钮，应该弹出确认对话框

**步骤 2：测试拖拽功能**

-   点击并拖拽面板标题栏
-   面板应该可以移动到页面的任意位置
-   松开鼠标后面板应该停留在新位置

**步骤 3：测试搜索过滤**

-   在面板搜索框输入关键词
-   历史记录应该实时过滤显示匹配的记录
-   清空搜索框，所有记录应该重新显示

### 4. 历史记录操作测试

**步骤 1：测试记录点击**

-   点击任意历史记录项
-   应该在新标签页中打开对应的搜索结果

**步骤 2：测试记录删除**

-   悬停在历史记录上
-   右上角应该出现"×"删除按钮
-   点击删除按钮，应该弹出确认对话框
-   确认删除后，记录应该从列表中移除

### 5. 插件图标测试

**步骤 1：图标点击**

-   点击浏览器工具栏中的插件图标
-   如果在交易页面，应该切换面板的显示/隐藏
-   如果不在交易页面，应该打开交易页面

## 🐛 常见问题排查

### 问题 1：面板没有出现

**可能原因：**

-   插件没有正确加载
-   页面 URL 不匹配

**解决方法：**

1. 检查控制台是否有错误信息（F12 → Console）
2. 确认 URL 包含 `/trade2` 或 `/trade`
3. 重新加载插件
4. 刷新页面

### 问题 2：搜索记录没有保存

**可能原因：**

-   搜索参数提取失败
-   消息传递失败

**解决方法：**

1. 打开控制台查看日志信息
2. 手动点击 🔄 刷新按钮
3. 尝试不同的搜索方式

### 问题 3：面板样式异常

**可能原因：**

-   网站样式冲突
-   CSS 加载失败

**解决方法：**

1. 检查控制台 CSS 错误
2. 尝试拖拽面板到不同位置
3. 刷新页面重新加载

## 📊 测试结果检查清单

-   [ ] 面板正确显示在交易页面右侧
-   [ ] 搜索操作能自动保存记录
-   [ ] 历史记录按时间正确排序
-   [ ] 面板可以正常收起/展开
-   [ ] 面板可以自由拖拽移动
-   [ ] 搜索过滤功能正常工作
-   [ ] 点击记录能正确跳转
-   [ ] 删除记录功能正常
-   [ ] 清空历史功能正常
-   [ ] 插件图标点击响应正常

## 🔍 调试信息

如果遇到问题，请检查以下调试信息：

1. **控制台日志**（F12 → Console）

    - 查找"POE2 交易助手已加载"消息
    - 查找任何错误或警告信息

2. **网络请求**（F12 → Network）

    - 确认没有资源加载失败

3. **扩展程序页面**（chrome://extensions/）
    - 检查插件是否启用
    - 查看是否有错误信息

---

如果所有测试都通过，说明插件升级成功！现在你可以享受类似 Better Trading 的页面内嵌历史记录功能了。
